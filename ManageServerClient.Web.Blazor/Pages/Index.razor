@page "/"

@inject ILogger<Index> _logger
@inject IServerApi _serverApi

<h1>
    所有服务节点
</h1>

<p>监控客户端登陆后获取所有的被监控的服务器节点</p>

@if (serviceNodeInfos == null)
{
    <p><em>加载中，请稍后...</em></p>
}
else
{
    <table class="table">
        <thead>
            <tr>
                <th>服务标识</th>
                <th>服务id</th>
                <th>服务类型</th>
                <th>服务ip</th>
                <th>端口</th>
                <th>描述</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var serviceNodeInfo in serviceNodeInfos)
            {
            <tr>
                <td>@serviceNodeInfo.identity</td>
                <td>@serviceNodeInfo.svrid</td>
                <td>@serviceNodeInfo.svrtype</td>
                <td>@serviceNodeInfo.ip</td>
                <td>@serviceNodeInfo.port</td>
                <td>@serviceNodeInfo.desc</td>
            </tr>
            }
        </tbody>
    </table>
}

@code {
    private List<ServiceNodeInfo> serviceNodeInfos;

    protected override async Task OnInitializedAsync()
    {
        var getResult = await _serverApi.TE_ALL_SVR_QRY(new RequestBase() { reqid = ServerEnum.TE_ALL_SVR_QRY });
        serviceNodeInfos = getResult.databody;
    }
}
